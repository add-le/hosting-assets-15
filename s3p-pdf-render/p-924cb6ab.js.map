{"version":3,"names":["locales","fetchLocaleStrings","url","componentName","locale","Promise","resolve","reject","Object","assign","myHeaders","Headers","myInit","method","headers","mode","cache","fetch","then","async","result","ok","json","getComponentClosestLanguage","element","closestElement","closest","lang","i18n","constructor","this","strings","tagName","toLowerCase","get","string","params","r","length","index","replace","error"],"sources":["./node_modules/@s3pweb/s3p-chart/dist/collection/utils/i18n.js"],"sourcesContent":["var locales = {};\nfunction fetchLocaleStrings(url, componentName, locale) {\n    // console.log('call fetch with', url, componentName, locale)\n    return new Promise((resolve, reject) => {\n        if (locales[locale]) {\n            resolve(Object.assign(Object.assign({}, locales[locale]['common']), locales[locale][componentName]));\n        }\n        else {\n            const myHeaders = new Headers();\n            const myInit = {\n                method: 'GET',\n                headers: myHeaders,\n                mode: 'cors',\n                cache: 'default'\n            };\n            // fetch(`${url}json/${locale}.json`, myInit).then(\n            fetch(`https://gedmouv.io/assets/i18n/s3p-chart/${locale}.json`, myInit).then(async (result) => {\n                //console.log(\"resultat\",result)\n                if (result.ok) {\n                    locales[locale] = await result.json();\n                    //console.log('receive', locales[locale])\n                    resolve(Object.assign(Object.assign({}, locales[locale]['common']), locales[locale][componentName]));\n                }\n                else\n                    reject();\n            }, () => reject());\n        }\n    });\n}\nfunction getComponentClosestLanguage(element) {\n    let closestElement = element.closest(\"[lang]\");\n    return closestElement ? closestElement.lang : \"fr\";\n}\nexport class i18n {\n    constructor(element) {\n        this.element = element;\n    }\n    async load(url, locale) {\n        if (locale) {\n            this.locale = locale;\n        }\n        else {\n            this.locale = getComponentClosestLanguage(this.element);\n        }\n        this.strings = await fetchLocaleStrings(url, this.element.tagName.toLowerCase(), this.locale);\n        //console.log('i18n []'+JSON.stringify(this.strings))\n    }\n    get(string, ...params) {\n        // console.log('try to i18n ' + string, params)\n        try {\n            let r = this.strings[string];\n            if (typeof r === 'string') {\n                if (params && params.length > 0) {\n                    for (let index in params) {\n                        //console.log('replace index', index, params[index])\n                        r = r.replace(`{{${index}}}`, params[index]);\n                    }\n                }\n                return r;\n            }\n            else {\n                return '?..?';\n            }\n        }\n        catch (error) {\n            // console.error(error)\n            return '?**?';\n        }\n    }\n}\n"],"mappings":"AAAA,IAAIA,EAAU,GACd,SAASC,EAAmBC,EAAKC,EAAeC,GAE5C,OAAO,IAAIC,SAAQ,CAACC,EAASC,KACzB,GAAIP,EAAQI,GAAS,CACjBE,EAAQE,OAAOC,OAAOD,OAAOC,OAAO,GAAIT,EAAQI,GAAQ,WAAYJ,EAAQI,GAAQD,IAChG,KACa,CACD,MAAMO,EAAY,IAAIC,QACtB,MAAMC,EAAS,CACXC,OAAQ,MACRC,QAASJ,EACTK,KAAM,OACNC,MAAO,WAGXC,MAAM,4CAA4Cb,SAAeQ,GAAQM,MAAKC,MAAOC,IAEjF,GAAIA,EAAOC,GAAI,CACXrB,EAAQI,SAAgBgB,EAAOE,OAE/BhB,EAAQE,OAAOC,OAAOD,OAAOC,OAAO,GAAIT,EAAQI,GAAQ,WAAYJ,EAAQI,GAAQD,IACxG,MAEoBI,GAAQ,IACb,IAAMA,KACrB,IAEA,CACA,SAASgB,EAA4BC,GACjC,IAAIC,EAAiBD,EAAQE,QAAQ,UACrC,OAAOD,EAAiBA,EAAeE,KAAO,IAClD,CACO,MAAMC,EACTC,YAAYL,GACRM,KAAKN,QAAUA,CACvB,CACIL,WAAWjB,EAAKE,GACZ,GAAIA,EAAQ,CACR0B,KAAK1B,OAASA,CAC1B,KACa,CACD0B,KAAK1B,OAASmB,EAA4BO,KAAKN,QAC3D,CACQM,KAAKC,cAAgB9B,EAAmBC,EAAK4B,KAAKN,QAAQQ,QAAQC,cAAeH,KAAK1B,OAE9F,CACI8B,IAAIC,KAAWC,GAEX,IACI,IAAIC,EAAIP,KAAKC,QAAQI,GACrB,UAAWE,IAAM,SAAU,CACvB,GAAID,GAAUA,EAAOE,OAAS,EAAG,CAC7B,IAAK,IAAIC,KAASH,EAAQ,CAEtBC,EAAIA,EAAEG,QAAQ,KAAKD,MAAWH,EAAOG,GAC7D,CACA,CACgB,OAAOF,CACvB,KACiB,CACD,MAAO,MACvB,CACA,CACQ,MAAOI,GAEH,MAAO,MACnB,CACA,S"}