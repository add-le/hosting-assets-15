{"version":3,"names":["sequence","start","stop","step","n","arguments","length","i","Math","max","ceil","range","Array","implicit","name","ordinal","index","map","domain","unknown","scale","d","key","get","set","push","_","slice","has","call","copy","initRange","apply","band","undefined","ordinalRange","bandwidth","round","paddingInner","paddingOuter","align","rescale","reverse","floor","values","rangeRound","padding","min","prototype","none$1","series","order","j","s0","s1","m","isNaN","none","o","stackValue","stack","keys","constant","orderNone","offset","offsetNone","value","data","kz","this","sz","oz","ki","si","sij","chartCumulCss","ChartCumul","constructor","hostRef","idChart","margin","top","right","bottom","left","toHHMMSS","toShortHHMM","log","debug","async","i18n","element","load","resourcesUrl","totals","JSON","parse","height","chart_width","chart_height","initialization","createPatternRest","svg","append","attr","d3.select","d3.stack","stack_data","layer","selectAll","enter","style","xScale","d3.scaleLinear","d3.max","yScale","d3.scaleBand","period","createRect","createAxis","createLabel","tooltip","text","there","on","displayPath","coords","d3.mouse","x","val","select","Object","xAxis","d3.axisBottom","tickValues","setValueAxesX","tickFormat","yAxis","d3.axisLeft","t","addAxeYText","each","self","hours","minute","textNode","end","today","Date","beginToToday","setHours","day","getDay","beginThisWeek","setDate","getDate","beginLastWeek","last4week","begin","displayPathEvent","emit","componentDidUpdate","remove","render","h","class","id"],"sources":["./node_modules/d3-array/src/range.js","./node_modules/d3-scale/src/ordinal.js","./node_modules/d3-scale/src/band.js","./node_modules/d3-shape/src/array.js","./node_modules/d3-shape/src/offset/none.js","./node_modules/d3-shape/src/order/none.js","./node_modules/d3-shape/src/stack.js","./node_modules/@s3pweb/s3p-chart/dist/collection/components/chartCumul/chartCumul.css?tag=s3p-chart-cumul","./node_modules/@s3pweb/s3p-chart/dist/collection/components/chartCumul/chartCumul.js"],"sourcesContent":["export default function(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","import {map} from \"d3-collection\";\nimport {slice} from \"./array\";\nimport {initRange} from \"./init\";\n\nexport var implicit = {name: \"implicit\"};\n\nexport default function ordinal() {\n  var index = map(),\n      domain = [],\n      range = [],\n      unknown = implicit;\n\n  function scale(d) {\n    var key = d + \"\", i = index.get(key);\n    if (!i) {\n      if (unknown !== implicit) return unknown;\n      index.set(key, i = domain.push(d));\n    }\n    return range[(i - 1) % range.length];\n  }\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [], index = map();\n    var i = -1, n = _.length, d, key;\n    while (++i < n) if (!index.has(key = (d = _[i]) + \"\")) index.set(key, domain.push(d));\n    return scale;\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), scale) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return ordinal(domain, range).unknown(unknown);\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n","import {range as sequence} from \"d3-array\";\nimport {initRange} from \"./init\";\nimport ordinal from \"./ordinal\";\n\nexport default function band() {\n  var scale = ordinal().unknown(undefined),\n      domain = scale.domain,\n      ordinalRange = scale.range,\n      range = [0, 1],\n      step,\n      bandwidth,\n      round = false,\n      paddingInner = 0,\n      paddingOuter = 0,\n      align = 0.5;\n\n  delete scale.unknown;\n\n  function rescale() {\n    var n = domain().length,\n        reverse = range[1] < range[0],\n        start = range[reverse - 0],\n        stop = range[1 - reverse];\n    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);\n    if (round) step = Math.floor(step);\n    start += (stop - start - step * (n - paddingInner)) * align;\n    bandwidth = step * (1 - paddingInner);\n    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);\n    var values = sequence(n).map(function(i) { return start + step * i; });\n    return ordinalRange(reverse ? values.reverse() : values);\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = [+_[0], +_[1]], rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = [+_[0], +_[1]], round = true, rescale();\n  };\n\n  scale.bandwidth = function() {\n    return bandwidth;\n  };\n\n  scale.step = function() {\n    return step;\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, rescale()) : round;\n  };\n\n  scale.padding = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;\n  };\n\n  scale.paddingInner = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;\n  };\n\n  scale.paddingOuter = function(_) {\n    return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;\n  };\n\n  scale.align = function(_) {\n    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;\n  };\n\n  scale.copy = function() {\n    return band(domain(), range)\n        .round(round)\n        .paddingInner(paddingInner)\n        .paddingOuter(paddingOuter)\n        .align(align);\n  };\n\n  return initRange.apply(rescale(), arguments);\n}\n\nfunction pointish(scale) {\n  var copy = scale.copy;\n\n  scale.padding = scale.paddingOuter;\n  delete scale.paddingInner;\n  delete scale.paddingOuter;\n\n  scale.copy = function() {\n    return pointish(copy());\n  };\n\n  return scale;\n}\n\nexport function point() {\n  return pointish(band.apply(null, arguments).paddingInner(1));\n}\n","export var slice = Array.prototype.slice;\n","export default function(series, order) {\n  if (!((n = series.length) > 1)) return;\n  for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {\n    s0 = s1, s1 = series[order[i]];\n    for (j = 0; j < m; ++j) {\n      s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];\n    }\n  }\n}\n","export default function(series) {\n  var n = series.length, o = new Array(n);\n  while (--n >= 0) o[n] = n;\n  return o;\n}\n","import {slice} from \"./array.js\";\nimport constant from \"./constant.js\";\nimport offsetNone from \"./offset/none.js\";\nimport orderNone from \"./order/none.js\";\n\nfunction stackValue(d, key) {\n  return d[key];\n}\n\nexport default function() {\n  var keys = constant([]),\n      order = orderNone,\n      offset = offsetNone,\n      value = stackValue;\n\n  function stack(data) {\n    var kz = keys.apply(this, arguments),\n        i,\n        m = data.length,\n        n = kz.length,\n        sz = new Array(n),\n        oz;\n\n    for (i = 0; i < n; ++i) {\n      for (var ki = kz[i], si = sz[i] = new Array(m), j = 0, sij; j < m; ++j) {\n        si[j] = sij = [0, +value(data[j], ki, j, data)];\n        sij.data = data[j];\n      }\n      si.key = ki;\n    }\n\n    for (i = 0, oz = order(sz); i < n; ++i) {\n      sz[oz[i]].index = i;\n    }\n\n    offset(sz, oz);\n    return sz;\n  }\n\n  stack.keys = function(_) {\n    return arguments.length ? (keys = typeof _ === \"function\" ? _ : constant(slice.call(_)), stack) : keys;\n  };\n\n  stack.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), stack) : value;\n  };\n\n  stack.order = function(_) {\n    return arguments.length ? (order = _ == null ? orderNone : typeof _ === \"function\" ? _ : constant(slice.call(_)), stack) : order;\n  };\n\n  stack.offset = function(_) {\n    return arguments.length ? (offset = _ == null ? offsetNone : _, stack) : offset;\n  };\n\n  return stack;\n}\n","\n  ","import { Component, Element, Prop, h, Event } from '@stencil/core';\nimport debug from \"debug/src/browser\";\nimport * as d3 from 'd3';\nimport { toShortHHMM } from '../../utils/utils';\nimport { i18n } from '../../utils/i18n';\nexport class ChartCumul {\n    constructor() {\n        this.idChart = 's3pCumulsByResource';\n        this.margin = { top: 0, right: 0, bottom: 32, left: 150 };\n        //define function export to util\n        this.toHHMMSS = toShortHHMM;\n        this.log = debug('s3pChart:chartcumul');\n    }\n    async componentWillLoad() {\n        this.i18n = new i18n(this.element);\n        await this.i18n.load(this.resourcesUrl);\n    }\n    async componentDidLoad() {\n        //console.log('totals change', this.totals)\n        this.totals = typeof this.totals === \"string\" ? JSON.parse(this.totals) : this.totals;\n        this.height = 90;\n        this.chart_width = 1000 - this.margin.left - this.margin.right;\n        this.chart_height = this.height - this.margin.top - this.margin.bottom;\n        this.initialization(this.height);\n    }\n    createPatternRest() {\n        this.svg.append('defs')\n            .append('pattern')\n            .attr('id', () => { return 'pattern-stripe2'; })\n            .attr('width', 6)\n            .attr('height', 4)\n            .attr('patternUnits', 'userSpaceOnUse')\n            .attr('patternTransform', 'rotate(45)')\n            .append('rect')\n            .attr('width', 2)\n            .attr('height', 4)\n            .attr('transform', 'translate(0,0)')\n            .attr('fill', '#ababab');\n    }\n    initialization(height) {\n        this.svg = d3.select(`#${this.idChart}`).append(\"svg\")\n            .attr('viewBox', `0 0 1020 ${height}`)\n            .attr('preserveAspectRadio', 'xMidYMid')\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.margin.left + \",\" + this.margin.top + \")\");\n        var stack = d3.stack().keys([\n            'drive', 'work', 'available', 'rest'\n        ]);\n        this.createPatternRest();\n        this.stack_data = stack(this.totals);\n        this.layer = this.svg.selectAll(\".layer\")\n            .data(this.stack_data)\n            .enter().append(\"g\")\n            .attr(\"class\", \"layer\")\n            .style(\"fill\", (d) => {\n            if (d.key === 'drive') {\n                return \"var(--primary-drive-color,#01599d)\";\n            }\n            if (d.key === 'work') {\n                return \"var(--primary-work-color,#d0000d)\";\n            }\n            if (d.key === 'available') {\n                return \"var(--primary-available-color,#e67d20)\";\n            }\n            if (d.key === 'rest') {\n                return \"url(#pattern-stripe2)\";\n            }\n        });\n        this.xScale = d3.scaleLinear().rangeRound([0, this.chart_width]).domain([0, d3.max(this.stack_data, (data, i) => {\n                return d3.max(data, (d) => {\n                    return d[1];\n                });\n            })]);\n        this.yScale = d3.scaleBand().rangeRound([this.chart_height, 0]).padding(0.1).domain(this.totals.map(function (d) { return d.period; }));\n        this.createRect();\n        this.createAxis();\n        this.createLabel();\n    }\n    createRect() {\n        var tooltip = this.svg.append(\"g\")\n            .attr(\"id\", \"s3ptooltip\")\n            .style(\"display\", \"none\");\n        tooltip.append('rect')\n            .attr(\"x\", 0)\n            .attr(\"y\", 0)\n            .attr('fill', 'black')\n            .attr('opacity', 0.7)\n            .attr('width', 165)\n            .attr('height', 82)\n            .attr('rx', '5')\n            .attr('ry', '5');\n        let text = tooltip.append(\"text\")\n            .attr(\"x\", 0)\n            .attr(\"y\", 25)\n            .attr('fill', 'white')\n            .attr('font-size', 25)\n            .attr('font-weight', 'bold');\n        text.append(\"tspan\")\n            .attr(\"x\", 165 / 2)\n            .attr(\"dy\", \"0em\")\n            .attr(\"id\", \"activity\")\n            .attr('text-anchor', 'middle')\n            .attr(\"dominant-baseline\", \"middle\");\n        text.append(\"tspan\")\n            .attr(\"x\", 165 / 2)\n            .attr(\"dy\", \"1.5em\")\n            .attr(\"id\", \"time\")\n            .attr('text-anchor', 'middle')\n            .attr(\"dominant-baseline\", \"middle\");\n        let there = this;\n        // rectangle\n        this.layer.selectAll(\"rect\")\n            .data((d) => { return d; })\n            .enter().append(\"rect\")\n            .attr(\"class\", \"bar\")\n            .attr(\"y\", (d) => { return this.yScale(d.data.period); })\n            .attr(\"x\", (d) => { return this.xScale(d[0]); })\n            .attr(\"height\", this.yScale.bandwidth())\n            .attr(\"width\", (d) => {\n            return this.xScale(d[1]) - this.xScale(d[0]);\n        })\n            .attr(\"cursor\", \"pointer\")\n            .on('click', (d) => { this.displayPath(d); })\n            .on('mouseover', (d) => {\n            tooltip.style(\"display\", null);\n        })\n            .on('mouseout', function () {\n            tooltip.style(\"display\", \"none\");\n        })\n            .on(\"mousemove\", function (d) {\n            var coords = d3.mouse(this);\n            var x = coords[0] + 10;\n            if (x > 700) {\n                x = 700;\n            }\n            let val = d[1] - d[0];\n            tooltip.attr(\"transform\", \"translate(\" + x + \",\" + (0) + \")\");\n            tooltip.select(\"text\").select('#activity').text(() => {\n                for (const key of Object.keys(d.data)) {\n                    if (d.data[key] === val) {\n                        return there.i18n.get(key);\n                    }\n                }\n            });\n            tooltip.select(\"text\").select('#time').text(() => {\n                return there.toHHMMSS(val);\n            });\n        });\n    }\n    createAxis() {\n        this.xAxis = d3.axisBottom(this.xScale).tickValues(this.setValueAxesX()).tickFormat((d) => {\n            return this.toHHMMSS(d);\n        });\n        this.svg.append(\"g\")\n            .attr(\"class\", \"axis axis--x\")\n            .attr(\"transform\", \"translate(0,\" + (this.chart_height + 5) + \")\")\n            .call(this.xAxis)\n            .attr('font-size', 23)\n            .attr('font-weight', 'bold');\n        this.yAxis = d3.axisLeft(this.yScale);\n        this.svg.append(\"g\")\n            .attr(\"class\", \"axis axis--y\")\n            .attr(\"transform\", \"translate(0,0)\")\n            .call(this.yAxis)\n            .selectAll('.tick text')\n            .call((t) => { this.addAxeYText(t); });\n    }\n    addAxeYText(t) {\n        let there = this;\n        t.each(function (d) {\n            var self = d3.select(this);\n            // console.log(d)\n            let text = there.i18n.get(d);\n            self.text(text)\n                .attr('font-size', 23)\n                .attr('font-weight', 'bold');\n        });\n    }\n    setValueAxesX() {\n        var max = d3.max(this.stack_data, (data, i) => {\n            return d3.max(data, function (d) {\n                return d[1];\n            });\n        });\n        let hours = Math.floor(max / 3600);\n        let tickValues = [];\n        let step = Math.ceil(hours / 6);\n        if (step !== 0) {\n            for (let i = 0; i <= hours;) {\n                tickValues.push(i * 3600);\n                i = i + step;\n            }\n        }\n        else {\n            let minute = Math.floor(max / 60);\n            let step = Math.ceil(minute / 6);\n            if (step !== 0) {\n                for (let i = 0; i <= minute;) {\n                    tickValues.push(i * 60);\n                    i = i + step;\n                }\n            }\n        }\n        return tickValues;\n    }\n    createLabel() {\n        var textNode = this.layer.selectAll('text')\n            .data(function (d) { return d; })\n            .enter();\n        textNode.append('text')\n            .attr('stroke', 'white')\n            .attr('stroke-width', 4)\n            .attr('stroke-linejoin', 'round')\n            .attr('font-size', 26)\n            .attr('font-weight', 'bold')\n            .text((d) => {\n            if (this.xScale(d[1]) - this.xScale(d[0]) > 90) {\n                return this.toHHMMSS(d[1] - d[0]);\n            }\n        })\n            .attr('x', (d) => {\n            return this.xScale(d[0]) + ((this.xScale(d[1]) - this.xScale(d[0])) / 2);\n        })\n            .attr('y', (d) => {\n            return this.yScale(d.data.period) + this.yScale.bandwidth() / 2;\n        })\n            .attr(\"cursor\", \"pointer\")\n            .on('click', (d) => { this.displayPath(d); })\n            .attr(\"dominant-baseline\", \"middle\")\n            .attr('text-anchor', (d) => {\n            return 'middle';\n        });\n        textNode.append('text')\n            .attr('fill', 'black')\n            .attr('font-size', 26)\n            .attr('font-weight', 'bold')\n            .text((d) => {\n            if (this.xScale(d[1]) - this.xScale(d[0]) > 90) {\n                return this.toHHMMSS(d[1] - d[0]);\n            }\n        })\n            .attr('x', (d) => {\n            return this.xScale(d[0]) + ((this.xScale(d[1]) - this.xScale(d[0])) / 2);\n        })\n            .attr('y', (d) => {\n            return this.yScale(d.data.period) + this.yScale.bandwidth() / 2;\n        })\n            .attr(\"cursor\", \"pointer\")\n            .on('click', (d) => { this.displayPath(d); })\n            .attr(\"dominant-baseline\", \"middle\")\n            .attr('text-anchor', (d) => {\n            return 'middle';\n        });\n    }\n    displayPath(d) {\n        if (d.data.period) {\n            let start, end;\n            const today = new Date();\n            const beginToToday = new Date(today.setHours(0, 0, 0, 0)); // now at 0:00\n            const day = today.getDay(); // day at now\n            const beginThisWeek = new Date(today.setDate(today.getDate() - day + (day == 0 ? -6 : 1))).setHours(0, 0, 0, 0);\n            const beginLastWeek = new Date(today.setDate(today.getDate() - 7)).setHours(0, 0, 0, 0);\n            switch (d.data.period) {\n                case 'day':\n                    start = beginToToday;\n                    end = new Date(new Date().setHours(23, 59, 59, 59));\n                    break;\n                case 'yesterday':\n                    start = new Date(new Date().setDate(new Date().getDate() - 1)).setHours(0, 0, 0, 0);\n                    end = beginToToday;\n                    break;\n                case 'week':\n                    start = new Date(beginThisWeek);\n                    end = new Date(new Date().setHours(23, 59, 59, 59));\n                    break;\n                case 'twoWeeks':\n                    start = new Date(beginLastWeek);\n                    end = new Date(new Date().setHours(23, 59, 59, 59));\n                    break;\n                case 'fourWeeks':\n                    const last4week = new Date(today.setDate(new Date(beginLastWeek).getDate() - 14)).setHours(0, 0, 0, 0);\n                    start = new Date(last4week);\n                    end = new Date(new Date().setHours(23, 59, 59, 59));\n                    break;\n                case 'month':\n                    const begin = new Date(new Date().setDate(1));\n                    start = new Date(begin.setHours(0, 0, 0, 0));\n                    end = new Date(new Date().setHours(23, 59, 59, 59));\n                    break;\n            }\n            this.displayPathEvent.emit({\n                start: new Date(start),\n                end: new Date(end)\n            });\n        }\n    }\n    componentDidUpdate() {\n        this.log('totals change', this.totals);\n        d3.select(`#${this.idChart}`).selectAll('svg').remove();\n        this.totals = typeof this.totals === \"string\" ? JSON.parse(this.totals) : this.totals;\n        this.initialization(this.height);\n    }\n    render() {\n        return (h(\"div\", { class: \"s3pchart\" },\n            h(\"div\", { id: this.idChart, class: 'chartCumulsByResource' })));\n    }\n    static get is() { return \"s3p-chart-cumul\"; }\n    static get originalStyleUrls() { return {\n        \"$\": [\"chartCumul.css\"]\n    }; }\n    static get styleUrls() { return {\n        \"$\": [\"chartCumul.css\"]\n    }; }\n    static get properties() { return {\n        \"idChart\": {\n            \"type\": \"string\",\n            \"mutable\": false,\n            \"complexType\": {\n                \"original\": \"string\",\n                \"resolved\": \"string\",\n                \"references\": {}\n            },\n            \"required\": false,\n            \"optional\": false,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"attribute\": \"id-chart\",\n            \"reflect\": false,\n            \"defaultValue\": \"'s3pCumulsByResource'\"\n        },\n        \"totals\": {\n            \"type\": \"any\",\n            \"mutable\": false,\n            \"complexType\": {\n                \"original\": \"any\",\n                \"resolved\": \"any\",\n                \"references\": {}\n            },\n            \"required\": false,\n            \"optional\": false,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"attribute\": \"totals\",\n            \"reflect\": false\n        }\n    }; }\n    static get contextProps() { return [{\n            \"name\": \"resourcesUrl\",\n            \"context\": \"resourcesUrl\"\n        }]; }\n    static get events() { return [{\n            \"method\": \"displayPathEvent\",\n            \"name\": \"displayPathEvent\",\n            \"bubbles\": true,\n            \"cancelable\": true,\n            \"composed\": true,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"complexType\": {\n                \"original\": \"any\",\n                \"resolved\": \"any\",\n                \"references\": {}\n            }\n        }]; }\n    static get elementRef() { return \"element\"; }\n}\n"],"mappings":"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"}