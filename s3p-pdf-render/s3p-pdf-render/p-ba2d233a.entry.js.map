{"version":3,"names":["correctionsTableCss","CorrectionTable","constructor","hostRef","this","intervalDate","start","end","async","log","debug","i18n","el","load","resourcesUrl","Date","setHours","setInterval","ev","type","detail","setActivity","activity","h","class","title","src","setCustomActivity","activitiesOutsideVehicle","length","customActivity","find","_id","label","sendInterval","valueOf","sendIntervalCorrectionTable","emit","inputDateTimeStart","setError","inputDateTimeEnd","returnDurante","durante","toShortHHMM","render","get","idInput","date","ref","onDateTimeChange","onClick","name","center","listCorrection","rowSpan","colSpan","map","correction","resourceName","new","ts","prettyDate","origin","dispatcherName","creationTs","comment"],"sources":["./node_modules/@s3pweb/s3p-chart/dist/collection/components/corrections/corrections-table/corrections-table.css?tag=s3p-corrections-table","./node_modules/@s3pweb/s3p-chart/dist/collection/components/corrections/corrections-table/corrections-table.js"],"sourcesContent":[".intervalCorrection {\n    display: flex;\n    align-items: center;\n}\n.actionTable {\n    display: flex;\n    align-items: center;\n}\n.headerCorrection {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n}\n","import { Component, h, Prop, Element, Event, State } from '@stencil/core';\nimport debug from \"debug/src/browser\";\nimport { prettyDate, toShortHHMM } from \"../../../utils/utils\";\nimport { i18n } from '../../../utils/i18n';\nimport '@s3pweb/s3p-components-utils';\nexport class CorrectionTable {\n    constructor() {\n        this.intervalDate = { start: null, end: null };\n    }\n    async componentWillLoad() {\n        this.log = debug('s3pChart:correctionTable');\n        this.i18n = new i18n(this.el);\n        await this.i18n.load(this.resourcesUrl);\n        this.start = new Date().setHours(0, 0, 0, 0);\n        this.end = new Date();\n        this.intervalDate = { start: new Date(new Date().setHours(0, 0, 0, 0)), end: new Date() };\n    }\n    async componentDidLoad() {\n    }\n    /**\n     * change date in intervalDate\n     * @param ev\n     * @param type\n     */\n    setInterval(ev, type) {\n        this.intervalDate[type] = ev.detail;\n    }\n    /**\n     * return activity with icon\n     * @param activity\n     */\n    setActivity(activity) {\n        switch (activity) {\n            case \"R\":\n                return h(\"div\", { class: \"activity restActivity\", title: \"Repos\" },\n                    h(\"img\", { class: \"icon-tachy\", src: \"https://gedmouv.io/assets/Break.png\" }));\n            case \"A\":\n                return h(\"div\", { class: \"activity availableActivity\", title: \"Disponible\" },\n                    h(\"img\", { class: \"icon-tachy\", src: \"https://gedmouv.io/assets/Available.png\" }));\n            case \"W\":\n                return h(\"div\", { class: \"activity workActivity\", title: \"Travail\" },\n                    h(\"img\", { class: \"icon-tachy\", src: \"https://gedmouv.io/assets/Work.png\" }));\n            case \"D\":\n                return h(\"div\", { class: \"activity driverActivity\", title: \"Conduite\" },\n                    h(\"img\", { class: \"icon-tachy\", src: \"https://gedmouv.io/assets/Driving.png\" }));\n            default:\n                return h(\"div\", { class: \"activity otherActivity\" }, this.setCustomActivity(activity));\n        }\n    }\n    /**\n     * return activity custom\n     * @param activity\n     */\n    setCustomActivity(activity) {\n        if (this.activitiesOutsideVehicle && this.activitiesOutsideVehicle.length) {\n            const customActivity = this.activitiesOutsideVehicle.find((customActivity) => customActivity._id === activity);\n            return customActivity && customActivity.label ? customActivity.label : \"?\";\n        }\n        else {\n            return \"?\";\n        }\n    }\n    /**\n     * send event with start and end in input datetime\n     */\n    sendInterval() {\n        if (this.intervalDate.start && this.intervalDate.end && new Date(this.intervalDate.start).valueOf() < new Date(this.intervalDate.end).valueOf()) {\n            this.sendIntervalCorrectionTable.emit(this.intervalDate);\n            this.inputDateTimeStart.setError(false);\n            this.inputDateTimeEnd.setError(false);\n        }\n        else {\n            this.inputDateTimeStart.setError(true);\n            this.inputDateTimeEnd.setError(true);\n        }\n    }\n    /**\n     * return durante betwenn start and end\n     * @param start\n     * @param end\n     */\n    returnDurante(start, end) {\n        const durante = new Date(end).valueOf() - new Date(start).valueOf();\n        return toShortHHMM(durante / 1000);\n    }\n    render() {\n        return (h(\"div\", { class: \"s3pChartComponent\" },\n            h(\"div\", { class: \"headerCorrection\" },\n                h(\"div\", { class: \"intervalCorrection\" },\n                    h(\"span\", null, this.i18n.get(\"from\")),\n                    h(\"s3p-input-datetime\", { idInput: \"intervalStart\", date: this.start, ref: el => (this.inputDateTimeStart = el), onDateTimeChange: (ev) => { this.setInterval(ev, \"start\"); } }),\n                    h(\"span\", null, this.i18n.get(\"to\")),\n                    h(\"s3p-input-datetime\", { idInput: \"intervalEnd\", date: this.end, ref: el => (this.inputDateTimeEnd = el), onDateTimeChange: (ev) => { this.setInterval(ev, \"end\"); } }),\n                    h(\"button\", { class: \"btnChart\", onClick: () => { this.sendInterval(); } },\n                        h(\"s3p-icon-v2\", { name: \"checkmark\", center: true }))),\n                h(\"div\", { class: \"actionTable\" },\n                    h(\"button\", { class: \"btnChart\" },\n                        h(\"s3p-icon-v2\", { name: \"download-outline\", center: true })),\n                    h(\"button\", { class: \"btnChart\" },\n                        h(\"s3p-icon-v2\", { name: \"print-outline\", center: true })))),\n            this.listCorrection ?\n                h(\"table\", { class: \"tableCustom\" },\n                    h(\"tr\", null,\n                        h(\"th\", { rowSpan: 2 }, this.i18n.get(\"driver\")),\n                        h(\"th\", { colSpan: 4 }, this.i18n.get(\"newActivity\")),\n                        h(\"th\", { colSpan: 4 }, this.i18n.get(\"originalActivity\")),\n                        h(\"th\", { colSpan: 4 }, \"Action\")),\n                    h(\"tr\", null,\n                        h(\"th\", null, this.i18n.get(\"activity\")),\n                        h(\"th\", null, this.i18n.get(\"start\")),\n                        h(\"th\", null, this.i18n.get(\"end\")),\n                        h(\"th\", null, this.i18n.get(\"durante\")),\n                        h(\"th\", null, this.i18n.get(\"activity\")),\n                        h(\"th\", null, this.i18n.get(\"start\")),\n                        h(\"th\", null, this.i18n.get(\"end\")),\n                        h(\"th\", null, this.i18n.get(\"durante\")),\n                        h(\"th\", null, this.i18n.get(\"user\")),\n                        h(\"th\", null, \"Type\"),\n                        h(\"th\", null, \"Date\"),\n                        h(\"th\", null, this.i18n.get(\"comment\"))),\n                    this.listCorrection.map((correction) => (h(\"tr\", null,\n                        h(\"td\", null, correction.resourceName ? correction.resourceName : \"\"),\n                        h(\"td\", null, correction.new && correction.new.activity ? this.setActivity(correction.new.activity) : \"\"),\n                        h(\"td\", null, correction.new && correction.new.ts ?\n                            prettyDate(new Date(correction.new.ts), \"00/00/0000 00:00\") : \"\"),\n                        h(\"td\", null, correction.new && correction.new.end ?\n                            prettyDate(new Date(correction.new.end), \"00/00/0000 00:00\") : \"\"),\n                        h(\"td\", null, correction.new && correction.new.end && correction.new.ts ? this.returnDurante(correction.new.ts, correction.new.end) : \"\"),\n                        correction.origin ? [\n                            h(\"td\", null, this.setActivity(correction.origin.activity)),\n                            h(\"td\", null, prettyDate(new Date(correction.origin.ts), \"00/00/0000 00:00\")),\n                            h(\"td\", null, correction.new && correction.origin.end ?\n                                prettyDate(new Date(correction.origin.end), \"00/00/0000 00:00\") : \"\"),\n                            h(\"td\", null, correction.origin && correction.origin.end && correction.origin.ts ? this.returnDurante(correction.origin.ts, correction.origin.end) : \"\"),\n                        ] :\n                            h(\"td\", { colSpan: 4 }, this.i18n.get(\"noOriginalActivity\")),\n                        h(\"td\", null, correction.dispatcherName ? correction.dispatcherName : \"\"),\n                        h(\"td\", null, this.i18n.get(correction.type)),\n                        h(\"td\", null, prettyDate(new Date(correction.creationTs), \"00/00/0000 00:00\")),\n                        h(\"td\", null, correction.comment))))) : \"\"));\n    }\n    static get is() { return \"s3p-corrections-table\"; }\n    static get originalStyleUrls() { return {\n        \"$\": [\"corrections-table.css\"]\n    }; }\n    static get styleUrls() { return {\n        \"$\": [\"corrections-table.css\"]\n    }; }\n    static get properties() { return {\n        \"activitiesOutsideVehicle\": {\n            \"type\": \"any\",\n            \"mutable\": false,\n            \"complexType\": {\n                \"original\": \"any\",\n                \"resolved\": \"any\",\n                \"references\": {}\n            },\n            \"required\": false,\n            \"optional\": false,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"attribute\": \"activities-outside-vehicle\",\n            \"reflect\": false\n        },\n        \"listCorrection\": {\n            \"type\": \"any\",\n            \"mutable\": false,\n            \"complexType\": {\n                \"original\": \"any\",\n                \"resolved\": \"any\",\n                \"references\": {}\n            },\n            \"required\": false,\n            \"optional\": false,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"attribute\": \"list-correction\",\n            \"reflect\": false\n        }\n    }; }\n    static get contextProps() { return [{\n            \"name\": \"resourcesUrl\",\n            \"context\": \"resourcesUrl\"\n        }]; }\n    static get states() { return {\n        \"start\": {},\n        \"end\": {},\n        \"intervalDate\": {}\n    }; }\n    static get events() { return [{\n            \"method\": \"sendIntervalCorrectionTable\",\n            \"name\": \"sendIntervalCorrectionTable\",\n            \"bubbles\": true,\n            \"cancelable\": true,\n            \"composed\": true,\n            \"docs\": {\n                \"tags\": [],\n                \"text\": \"\"\n            },\n            \"complexType\": {\n                \"original\": \"any\",\n                \"resolved\": \"any\",\n                \"references\": {}\n            }\n        }]; }\n    static get elementRef() { return \"el\"; }\n}\n"],"mappings":"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"}